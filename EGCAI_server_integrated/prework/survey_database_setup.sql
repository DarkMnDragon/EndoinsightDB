CREATE TABLE surveys (
      survey_id INT PRIMARY KEY,
      title VARCHAR(255),
      description TEXT,
      date DATE,
      first_question_id INT,
      last_question_id INT

);

CREATE TABLE input_type (
      type_id INT PRIMARY KEY,
      name VARCHAR(50)
    
);

CREATE TABLE questions (
      question_id INT PRIMARY KEY,
      question_text VARCHAR(255),
      type_id INT,
      survey_id INT,
      FOREIGN KEY (type_id) REFERENCES input_type(type_id),
      FOREIGN KEY (survey_id) REFERENCES surveys(survey_id)
    
);

CREATE TABLE options (
      option_id INT PRIMARY KEY,
      option_text VARCHAR(255),
      question_id INT,
      FOREIGN KEY (question_id) REFERENCES questions(question_id)
    
);

CREATE TABLE question_logic (
      logic_id INT PRIMARY KEY,
      parent_question_id INT,
      parent_option_id INT,
      child_question_id INT,
      FOREIGN KEY (parent_question_id) REFERENCES questions(question_id),
      FOREIGN KEY (child_question_id) REFERENCES questions(question_id)
    
);


CREATE TABLE users (
    user_id VARCHAR(255) PRIMARY KEY,
    name VARCHAR(255),
    sex VARCHAR(10),
    nation VARCHAR(50),
    ID_number VARCHAR(18),
    birthday DATE,
    phone_number VARCHAR(20),
    family_member_phone_number VARCHAR(20),
    homeplace VARCHAR(100)
);

CREATE TABLE image_responses (
      image_responses_id INT PRIMARY KEY,
      time TIMESTAMP,
      input_image BYTEA,
      predict_image BYTEA,
      user_id VARCHAR(255),
      FOREIGN KEY (user_id) REFERENCES users(user_id)
    
);

CREATE TABLE responses (
      response_id VARCHAR(255) PRIMARY KEY,
      time TIMESTAMP,
      user_id VARCHAR(255),
      survey_id INT,
      current_question_id INT,
      FOREIGN KEY (user_id) REFERENCES users(user_id),
      FOREIGN KEY (survey_id) REFERENCES surveys(survey_id) 
    
);

CREATE TABLE question_responses (
      question_response_id VARCHAR(255) PRIMARY KEY,
      answer TEXT,
      response_id VARCHAR(255),
      question_id INT,
      FOREIGN KEY (response_id) REFERENCES responses(response_id),
      FOREIGN KEY (question_id) REFERENCES questions(question_id) 
    
);

CREATE TABLE selected_option (
      selected_option_id VARCHAR(255) PRIMARY KEY,
      question_response_id VARCHAR(255),
      option_id INT,
      FOREIGN KEY (question_response_id) REFERENCES question_responses(question_response_id),
      FOREIGN KEY (option_id) REFERENCES options(option_id) 
    
);

CREATE TABLE lists (
      list_id VARCHAR(255) PRIMARY KEY,
      parent_question_id INT,
      child_question_id INT,
      response_id VARCHAR(255),
      FOREIGN KEY (parent_question_id) REFERENCES questions(question_id),
      FOREIGN KEY (child_question_id) REFERENCES questions(question_id),
      FOREIGN KEY (response_id) REFERENCES responses(response_id)
);
	
INSERT INTO surveys (survey_id, title, description, date, first_question_id, last_question_id) VALUES (1, '疾病预测问卷调查', '', '2023-11-03', 1, 56);

INSERT INTO input_type (type_id, name) VALUES (0, '填空'),
(1, '单选'),
(2, '多选');

INSERT INTO questions (question_id, question_text, type_id, survey_id) VALUES (1, '您的身高是?', 0, 1),
(2, '您的体重是?', 0, 1),
(3, '您是否长期居住于出生地?', 1, 1),
(4, '家庭住址（省市县街道小区）?', 0, 1),
(5, '长期居住地地区名称（省市县街道小区）?', 0, 1),
(6, '居住时长?', 1, 1),
(7, '出生地地区名称（省市县）?', 0, 1),
(8, '居住时长?', 1, 1),
(9, '您是否有过幽门螺旋杆菌（Hp）感染?', 1, 1),
(10, '确诊时间年?', 0, 1),
(11, '确诊时间月?', 0, 1),
(12, '是否根除?', 1, 1),
(13, '根除完成时间年?', 0, 1),
(14, '根除完成时间月?', 0, 1),
(15, '您是否有龋齿（虫牙）、缺齿、口臭?', 1, 1),
(16, '您的饮食口味偏好是?', 2, 1),
(17, '您是否存在以下饮食习惯?', 2, 1),
(18, '您吸烟吗?', 1, 1),
(19, '吸烟几年?', 0, 1),
(20, '平均每天几支?', 0, 1),
(21, '吸烟几年?', 0, 1),
(22, '平均每天几支?', 0, 1),
(23, '戒烟几年?', 0, 1),
(24, '您饮酒吗?', 1, 1),
(25, '饮酒几年?', 0, 1),
(26, '饮酒频率?', 1, 1),
(27, '平均每天多少ml?', 0, 1),
(28, '饮什么酒?', 0, 1),
(29, '饮酒几年?', 0, 1),
(30, '饮酒频率?', 1, 1),
(31, '平均每天多少ml?', 0, 1),
(32, '饮什么酒?', 0, 1),
(33, '戒酒几年?', 0, 1),
(34, '您是否有长期在吃的药物?', 1, 1),
(35, '药物具体名称?', 0, 1),
(36, '剂量?', 0, 1),
(37, '服用时间?', 0, 1),
(38, '服用原因?', 0, 1),
(39, '您现在是否患有以下某种疾病?', 2, 1),
(40, '您现在是否患有以下某种疾病?', 2, 1),
(41, '您过去是否患有以下某种疾病?', 2, 1),
(42, '您是否做过手术?', 1, 1),
(43, '疾病名称?', 0, 1),
(44, '手术时间（年）?', 0, 1),
(45, '手术时间（月）?', 0, 1),
(46, '手术方式?', 0, 1),
(47, '您的一级亲属中是否有人患过肿瘤?', 1, 1),
(48, '称谓（与本人关系）?', 0, 1),
(49, '肿瘤详细名称（仅*填写一级亲属）?', 0, 1),
(50, '您是否有确诊的精神疾病（如焦虑、抑郁等）?', 1, 1),
(51, '疾病具体名称?', 0, 1),
(52, '疾病严重程度?', 0, 1),
(53, '病程时间?', 0, 1),
(54, '治疗措施?', 0, 1),
(55, '目前状况?', 0, 1),
(56, '您自我评价精神压力情况是?', 1, 1);

INSERT INTO options (option_id, option_text, question_id) VALUES (1, '是', 3),
(2, '否', 3),
(3, '小于一个月', 6),
(4, '一个月到半年', 6),
(5, '半年到三年', 6),
(6, '三年以上', 6),
(7, '小于一个月', 8),
(8, '一个月到半年', 8),
(9, '半年到三年', 8),
(10, '三年以上', 8),
(11, '是', 9),
(12, '已根除', 12),
(13, '根除失败', 12),
(14, '未根除', 12),
(15, '否', 9),
(16, '不详', 9),
(17, '是', 15),
(18, '否', 15),
(19, '不详', 15),
(20, '高盐', 16),
(21, '高糖', 16),
(22, '高油', 16),
(23, '喜烫食', 16),
(24, '喜烟熏食物', 16),
(25, '喜油炸食物', 16),
(26, '喜腌菜', 16),
(27, '喜红肉或加工肉类', 16),
(28, '以上均无', 16),
(29, '长期不吃早餐', 17),
(30, '少食蔬果', 17),
(31, '饮食不规律', 17),
(32, '暴饮暴食', 17),
(33, '吃饭速度快', 17),
(34, '吃剩饭菜', 17),
(35, '以上均无', 17),
(36, '吸烟，未戒', 18),
(37, '吸过烟，已戒', 18),
(38, '从不吸烟', 18),
(39, '喝酒，未戒', 24),
(40, '经常', 26),
(41, '偶尔', 26),
(42, '以前喝，已戒', 24),
(43, '经常', 30),
(44, '偶尔', 30),
(45, '从不喝酒', 24),
(46, '不详', 24),
(47, '有', 34),
(48, '无', 34),
(49, '不详', 34),
(50, '高血压', 39),
(51, '冠心病', 39),
(52, '糖尿病', 39),
(53, '慢性阻塞性肺部疾病', 39),
(54, '慢性心力衰竭', 39),
(55, '慢性肾衰', 39),
(56, '甲亢', 39),
(57, '甲减', 39),
(58, '胃炎', 40),
(59, '消化性溃疡', 40),
(60, '胃食管反流病', 40),
(61, '胃癌', 40),
(62, '食管癌', 40),
(63, '炎症性肠病', 40),
(64, '结直肠癌', 40),
(65, '胰腺癌', 40),
(66, '肝炎', 40),
(67, '肝硬化', 40),
(68, '胃炎', 41),
(69, '消化性溃疡', 41),
(70, '胃食管反流病', 41),
(71, '胃癌', 41),
(72, '食管癌', 41),
(73, '炎症性肠病', 41),
(74, '结直肠癌', 41),
(75, '胰腺癌', 41),
(76, '有', 42),
(77, '无', 42),
(78, '不详', 42),
(79, '有', 47),
(80, '无', 47),
(81, '不详', 47),
(82, '是', 50),
(83, '否', 50),
(84, '非常大', 56),
(85, '有点大', 56),
(86, '一般', 56),
(87, '没有', 56),
(88, '不详', 56);

INSERT INTO question_logic (logic_id, parent_question_id, parent_option_id, child_question_id) VALUES (1, 1, 0, 2),
(2, 2, 0, 3),
(3, 3, 1, 4),
(4, 3, 2, 5),
(5, 5, 0, 6),
(6, 6, 6, 7),
(7, 6, 5, 7),
(8, 6, 4, 7),
(9, 6, 3, 7),
(10, 7, 0, 8),
(11, 8, 10, 9),
(12, 8, 9, 9),
(13, 8, 8, 9),
(14, 8, 7, 9),
(15, 4, 0, 9),
(16, 9, 11, 10),
(17, 10, 0, 11),
(18, 11, 0, 12),
(19, 12, 12, 13),
(20, 13, 0, 14),
(21, 9, 16, 15),
(22, 9, 15, 15),
(23, 12, 14, 15),
(24, 12, 13, 15),
(25, 14, 0, 15),
(26, 15, 19, 16),
(27, 15, 18, 16),
(28, 15, 17, 16),
(29, 16, 28, 17),
(30, 16, 27, 17),
(31, 16, 26, 17),
(32, 16, 25, 17),
(33, 16, 24, 17),
(34, 16, 23, 17),
(35, 16, 22, 17),
(36, 16, 21, 17),
(37, 16, 20, 17),
(38, 17, 35, 18),
(39, 17, 34, 18),
(40, 17, 33, 18),
(41, 17, 32, 18),
(42, 17, 31, 18),
(43, 17, 30, 18),
(44, 17, 29, 18),
(45, 18, 36, 19),
(46, 19, 0, 20),
(47, 18, 37, 21),
(48, 21, 0, 22),
(49, 22, 0, 23),
(50, 18, 38, 24),
(51, 23, 0, 24),
(52, 20, 0, 24),
(53, 24, 39, 25),
(54, 25, 0, 26),
(55, 26, 40, 27),
(56, 26, 41, 28),
(57, 27, 0, 28),
(58, 24, 42, 29),
(59, 29, 0, 30),
(60, 30, 43, 31),
(61, 30, 44, 32),
(62, 31, 0, 32),
(63, 32, 0, 33),
(64, 24, 46, 34),
(65, 24, 45, 34),
(66, 33, 0, 34),
(67, 28, 0, 34),
(68, 34, 47, 35),
(69, 35, 0, 36),
(70, 36, 0, 37),
(71, 37, 0, 38),
(72, 34, 49, 39),
(73, 34, 48, 39),
(74, 38, 0, 39),
(75, 39, 57, 40),
(76, 39, 56, 40),
(77, 39, 55, 40),
(78, 39, 54, 40),
(79, 39, 53, 40),
(80, 39, 52, 40),
(81, 39, 51, 40),
(82, 39, 50, 40),
(83, 40, 67, 41),
(84, 40, 66, 41),
(85, 40, 65, 41),
(86, 40, 64, 41),
(87, 40, 63, 41),
(88, 40, 62, 41),
(89, 40, 61, 41),
(90, 40, 60, 41),
(91, 40, 59, 41),
(92, 40, 58, 41),
(93, 41, 75, 42),
(94, 41, 74, 42),
(95, 41, 73, 42),
(96, 41, 72, 42),
(97, 41, 71, 42),
(98, 41, 70, 42),
(99, 41, 69, 42),
(100, 41, 68, 42),
(101, 42, 76, 43),
(102, 43, 0, 44),
(103, 44, 0, 45),
(104, 45, 0, 46),
(105, 42, 78, 47),
(106, 42, 77, 47),
(107, 46, 0, 47),
(108, 47, 79, 48),
(109, 48, 0, 49),
(110, 47, 81, 50),
(111, 47, 80, 50),
(112, 49, 0, 50),
(113, 50, 82, 51),
(114, 51, 0, 52),
(115, 52, 0, 53),
(116, 53, 0, 54),
(117, 54, 0, 55),
(118, 50, 83, 56),
(119, 55, 0, 56);
